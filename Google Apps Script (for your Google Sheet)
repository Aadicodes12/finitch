function doPost(e) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var data = JSON.parse(e.postData.contents);
  var email = data.email;

  if (email) {
    sheet.appendRow([new Date(), email]);
    return ContentService.createTextOutput(JSON.stringify({ status: "success", message: "Email added to waitlist." }))
      .setMimeType(ContentService.MimeType.JSON);
  } else {
    return ContentService.createTextOutput(JSON.stringify({ status: "error", message: "No email provided." }))
      .setMimeType(ContentService.MimeType.JSON);
  }
}